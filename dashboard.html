<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard KhÃ¡ch hÃ ng má»›i BÆ°u Ä‘iá»‡n Quáº£ng Nam</title>
    <link rel="icon" href="Logo.png" type="image/png">
    <style>
        @font-face {
            font-family: 'Aptos';
            src: url('path/to/aptos-font.woff2') format('woff2'),
                 url('path/to/aptos-font.woff') format('woff');
            font-weight: normal;
            font-style: normal;
        }
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            font-family: 'Aptos', Arial, sans-serif;
            background-color: #f4f4f4;
        }
        .header {
            background-color: #4CAF50;
            color: white;
            padding: 7.5px; /* Reduced padding to half */
            text-align: center;
            font-size: 24px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .container {
            padding: 20px;
        }
        iframe {
            width: 100%;
            height: calc(100vh - 45px); /* Adjust height based on reduced header height */
            border: none;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        .capture-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            font-size: 20px;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <div class="header">
        Dashboard KhÃ¡ch hÃ ng má»›i BÆ°u Ä‘iá»‡n Quáº£ng Nam
    </div>
    <div class="container">
        <iframe title="Dashboard Tuáº§n 51" src="https://app.powerbi.com/view?r=eyJrIjoiMTI3YzFmNTgtMDMyNi00ZTJiLWExMTAtMzBkZDE3ZDQzNTgwIiwidCI6IjRkNmQ2N2FlLTViNTUtNDJhYy05ZGFhLTkzOTk3Yzc3YTg3YSIsImMiOjEwfQ%3D%3D" allowFullScreen="true"></iframe>
    </div>
    <button class="capture-btn" onclick="capturePage()">ðŸ“¸</button>
    <script>
        async function capturePage() {
            try {
                const stream = await navigator.mediaDevices.getDisplayMedia({
                    video: {
                        displaySurface: 'monitor',
                        cursor: 'always'
                    }
                });
                const track = stream.getVideoTracks()[0];
                const imageCapture = new ImageCapture(track);
                const bitmap = await imageCapture.grabFrame();
                track.stop();

                const canvas = document.createElement('canvas');
                canvas.width = bitmap.width;
                canvas.height = bitmap.height;
                const context = canvas.getContext('2d');
                context.drawImage(bitmap, 0, 0, bitmap.width, bitmap.height);

                canvas.toBlob(blob => {
                    const item = new ClipboardItem({ "image/png": blob });
                    navigator.clipboard.write([item]);
                    alert("áº¢nh Ä‘Ã£ Ä‘Æ°á»£c lÆ°u vÃ o clipboard!");
                });
            } catch (err) {
                console.error("Error: " + err);
                alert("KhÃ´ng thá»ƒ chá»¥p áº£nh mÃ n hÃ¬nh: " + err.message);
            }
        }
    </script>
</body>
</html>